import{$ as O,C as E,G as H,R as w,S as T,T as U,U as b,V as k,W as M,X as A,_ as F,b as p,ca as L,ea as j,f as c,fa as D,g as d,h as f,i as g,j as l,k as s,l as i,n as h,o as v,p as n,q as I,r as x,v as S,w as C,x as _,y,z as P}from"./chunk-JXJ27R3R.js";import"./chunk-QSTOU7CW.js";import"./chunk-QUJFQN2Y.js";import"./chunk-QNDG2AIA.js";import"./chunk-LEAR6PG4.js";import"./chunk-3DLEGXFE.js";import"./chunk-BZEB2UY2.js";import"./chunk-PZOBMGCJ.js";import"./chunk-YEZZ6QDO.js";import"./chunk-QIXCRKT2.js";import"./chunk-QNCTVU3D.js";import"./chunk-GJIUCB5T.js";import"./chunk-PZ5P6VYW.js";import"./chunk-QRBIBPJF.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-BLXM4U4C.js";import"./chunk-CKP3SGE2.js";import"./chunk-FJ7OIONH.js";import"./chunk-U2DYKTP5.js";import"./chunk-2URBEDWI.js";import"./chunk-TJNWXUBL.js";import"./chunk-BUMCRR6Y.js";import"./chunk-DNTR6X5U.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{h as u}from"./chunk-B7O3QC5Z.js";function N(o,a){o&1&&(s(0,"div",7),n(1," Verificando autenticaci\xF3n... "),i())}function B(o,a){if(o&1&&(s(0,"div",8)(1,"h3"),n(2,"Informaci\xF3n del Usuario:"),i(),s(3,"pre"),n(4),S(5,"json"),i()()),o&2){let V=v();c(4),I(C(5,1,V.userInfo))}}function z(o,a){o&1&&(s(0,"div",9)(1,"p"),n(2,"No se pudo obtener informaci\xF3n del usuario"),i()())}var Z=(()=>{let a=class a{constructor(r,e,t,m){this.http=r,this.toastController=e,this.router=t,this.authService=m,this.authStatus="Verificando...",this.userInfo=null,this.isLoading=!0}ngOnInit(){console.log("\u{1F3E0} HomePage: ngOnInit iniciado"),this.checkAuthStatus()}checkAuthStatus(){return u(this,null,function*(){console.log("\u{1F3E0} HomePage: Verificando estado de autenticaci\xF3n...");let r=yield this.authService.getUser();console.log("\u{1F3E0} HomePage: Usuario almacenado:",r),r&&(console.log("\u{1F3E0} HomePage: Usuario encontrado en storage, configurando datos..."),this.userInfo=r,this.authStatus="Usuario autenticado desde storage",this.isLoading=!1,console.log("\u{1F3E0} HomePage: Usuario configurado desde storage"));try{let e=yield p(this.http.get(`${D.apiUrl}/user/profile`));if(console.log("Auth check response:",e),this.authStatus="Autenticado correctamente",this.userInfo=e.data,e.data){let t={user:e.data,message:"Profile loaded successfully"};yield this.authService.setUserData(t)}this.showToast("Autenticaci\xF3n con cookies exitosa")}catch(e){this.authStatus="Error de autenticaci\xF3n",this.userInfo=null,this.showToast("Error: "+(e.error?.message||"No se pudo verificar la autenticaci\xF3n"))}finally{this.isLoading=!1}})}logout(){return u(this,null,function*(){yield this.authService.clearUserData(),this.router.navigate(["/login"])})}showToast(r){return u(this,null,function*(){yield(yield this.toastController.create({message:r,duration:3e3,position:"bottom"})).present()})}};a.\u0275fac=function(e){return new(e||a)(d(E),d(L),d(H),d(j))},a.\u0275cmp=f({type:a,selectors:[["app-home"]],decls:20,vars:6,consts:[[3,"translucent"],[3,"fullscreen"],[1,"container"],["class","loading",4,"ngIf"],["class","success",4,"ngIf"],["class","error",4,"ngIf"],["expand","block","fill","outline","color","danger",2,"margin-top","20px",3,"click"],[1,"loading"],[1,"success"],[1,"error"]],template:function(e,t){e&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),n(3,"Home"),i()()(),s(4,"ion-content",1)(5,"div",2)(6,"ion-card")(7,"ion-card-header")(8,"ion-card-title"),n(9,"Estado de Autenticaci\xF3n"),i()(),s(10,"ion-card-content")(11,"p")(12,"strong"),n(13,"Estado:"),i(),n(14),i(),g(15,N,2,0,"div",3)(16,B,6,3,"div",4)(17,z,3,0,"div",5),i()(),s(18,"ion-button",6),h("click",function(){return t.logout()}),n(19," Cerrar Sesi\xF3n "),i()()()),e&2&&(l("translucent",!0),c(4),l("fullscreen",!0),c(10),x(" ",t.authStatus),c(),l("ngIf",t.isLoading),c(),l("ngIf",t.userInfo&&!t.isLoading),c(),l("ngIf",!t.userInfo&&!t.isLoading))},dependencies:[A,O,F,M,w,T,U,b,k,P,_,y],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:600px;margin:0 auto}.loading[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic}.success[_ngcontent-%COMP%]{color:#28a745}.error[_ngcontent-%COMP%]{color:#dc3545}pre[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:10px;border-radius:4px;overflow-x:auto;font-size:12px}"]});let o=a;return o})();export{Z as HomePage};
